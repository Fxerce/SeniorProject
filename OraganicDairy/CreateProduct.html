<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Product</title>
    <link rel="stylesheet" href="CreateProductStyle.css">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="container">
                <div class="brand">
                    <h1 class="Purely">Purely</h1>
                    <h1 class="Trace">Trace</h1>
                </div>
                <ul class="nav-links">
                    <li><a href="#">General Information</a></li>
                    <li class="dropdown">
                        <a href="#" class="dropbtn">Product</a>
                        <div class="dropdown-content">
                            <a href="#">Receive Raw Milk</a>
                            <a href="#">Create Product</a>
                        </div>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropbtn">Product Lot</a>
                        <div class="dropdown-content">
                            <a href="#">Create Product Lot</a>
                            <a href="#">Manage Product Lot</a>
                        </div>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropbtn">More</a>
                        <div class="dropdown-content">
                            <a href="#">Profile</a>
                            <a href="#">Setting</a>
                            <a href="#">Log Out</a>
                        </div>
                    </li>
                </ul>
            </div>
        </nav>
    </header>
    <h1>Create Product</h1>
    <form id="ProductForm" action="/submit" method="POST">
    <div class="form-container">
        <div class="left-container">
            <div class="container-l1">
                <label class="boldLabel" for="ProductName" style="font-size: 2.5rem;">Product Name</label>
                <input type="text" name="ProductName" id="ProductName" placeholder="Enter the product name." required><br>
                <!--Ingredients-->
                        <label for="mainCheckbox" style="font-size: 2.5rem;">Ingredients</label><br>
                            <!--Protein-->
                            <label for="subCheckbox1" style="margin-left: 2%;">Protein</label>
                            <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                            <label for="subCheckbox1">G.</label><br>
                            <!--Fat-->
                            <label for="subCheckbox2" style="margin-left: 2%;">Total Fat</label>
                            <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                            <label for="subCheckbox1">G.</label><br>
                            <!--Sub-Checkboxes for Fat-->
                            <div class="SubCBFat">
                                <!--ไขมันอิ่มตัว-->
                                <input type="checkbox" name="SubCBFat1" id="subCBFat" style="margin-left: 2%;">
                                <label for="subCBFat">Saturated Fat</label>
                                <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                                <label for="subCBFat">G.</label><br>
                                <!--ไขมันไม่อิ่มตัวเชิงเดียว-->
                                <input type="checkbox" name="SubCBFat1" id="subCBFat" style="margin-left: 2%;">
                                <label for="subCBFat">Monounsaturated Fat</label>
                                <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                                <label for="subCBFat">G.</label><br>
                                <!--ไขมันไม่อิ่มตัวเชิงซ้อน-->
                                <input type="checkbox" name="SubCBFat1" id="subCBFat" style="margin-left: 2%;">
                                <label for="subCBFat">Polyunsaturated Fat</label>
                                <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                                <label for="subCBFat">G.</label><br>
                                <!--ไขมันทรานส์ธรรมชาติ-->
                                <input type="checkbox" name="SubCBFat1" id="subCBFat" style="margin-left: 2%;">
                                <label for="subCBFat">Natural Trans Fats</label>
                                <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                                <label for="subCBFat">G.</label><br>
                            </div>
                            <!--Carbohydrates-->
                            <label for="subCheckbox1" style="margin-left: 2%;">Carbohydrates</label>
                            <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                            <label for="subCheckbox1">G.</label><br>
                            <!--Minerals-->
                            </div>
                            <label for="mainCheckbox" style="font-size: 2.5rem;">Minerals</label><br>
                            <div class="SubCBM">
                                <!--Cholesterol-->
                                <label for="SubCBM" style="margin-left: 2%;">Cholesterol</label>
                                <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                                <label for="subCheckbox1">MG.</label><br>
                                <!--Sodium-->
                                <label for="SubCBM" style="margin-left: 2%;">Sodium</label>
                                <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                                <label for="subCheckbox1">MG.</label><br>
                                <!--Potassium-->
                                <label for="SubCBM" style="margin-left: 2%;">Potassium</label>
                                <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                                <label for="subCheckbox1">MG.</label><br>
                                <!--Magnesium-->
                                <label for="SubCBM" style="margin-left: 2%;">Magnesium</label>
                                <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                                <label for="subCheckbox1">MG.</label><br>
                                <!--VitaminC-->
                                <label for="SubCBM" style="margin-left: 2%;">Vitamin C</label>
                                <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                                <label for="subCheckbox1">MG.</label><br>
                                <!--VitaminD-->
                                <label for="SubCBM"style="margin-left: 2%;">Vitamin D</label>
                                <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                                <label for="subCheckbox1">MG.</label><br>
                                <!--VitaminB-->
                                <label for="SubCBM" style="margin-left: 2%;">Vitamin B</label>
                                <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                                <label for="subCheckbox1">MG.</label><br>
                                <!--Iron-->
                                <label for="SubCBM" style="margin-left: 2%;">Iron</label>
                                <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                                <label for="subCheckbox1">MG.</label><br>
                                <!--Cobalamin-->
                                <label for="SubCBM" style="margin-left: 2%;">Cobalamin</label>
                                <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                                <label for="subCheckbox1">MG.</label><br>
                            </div>    
            <div class="container-l2">
                <div>
                    <label class="boldLabel" for="Quantity" style="font-size: 2.5rem;">Nutritional Value</label>
                    <div class="SubNT">
                        <!--Calories-->
                        <label for="SubNT" style="margin-left: 2%;">Calories</label>
                        <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                        <label for="subCheckbox1">Kcal.</label><br>
                        <!--Sugar-->
                        <label for="SubNT" style="margin-left: 2%;">Sugar</label>
                        <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                        <label for="subCheckbox1">G.</label><br>
                        <!--Fat-->
                        <label for="SubNT" style="margin-left: 2%;">Fat</label>
                        <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                        <label for="subCheckbox1">G.</label><br>
                        <!--Sodium-->
                        <label for="SubNT" style="margin-left: 2%;">Sodium</label>
                        <input type="number" name="subtext1.1" id="subText1.1" step="0.01" placeholder="0.00" required>
                        <label for="subCheckbox1">MG.</label><br>
                    </div>
                </div>
                <div>
                    <label class="boldLabel" for="Quantity" style="font-size: 2.5rem;">Quantity</label>
                    <input type="number" id="Quantity" name="Quantity" step="0.01" placeholder="0.00" required>
                    <select name="QuantityUnit" id="QuantityUnit">
                        <option value="Liter">Liter</option>
                        <option value="Milliliter">Milliliter</option>
                        <option value="Ton">Ton</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="right-container">
            <div class="container-r1">
                <label class="boldLabel" for="Companyname" style="font-size: 2.5rem;">Company Name</label>
                <input type="text" id="Companyname" name="Companyname" placeholder="Enter company name" required>
            </div>
            <div class="container-r2">
                <label class="boldLabel" for="Facname" style="font-size: 2.5rem;">Fatory Name</label>
                <input type="text" id="Facname" name="Facname" placeholder="Enter factory name" required><br>
                <label class="boldLabel" for="Address" style="font-size: 2.5rem;">Address</label><br>
                <input type="text" name="Address" id="Address" placeholder="Enter your address" required><br>
                <label class="boldLabel" for="Location" style="font-size: 2.5rem;">Location</label>
                        <div id="Gmap" style="height: 400px; width: 400px;"></div>
                        <input type="url" name="LocationLink" id="LocationLink" placeholder="https://example.com/location" required>
            </div>
            <div class="container-r3">
                <label class="boldLabel" for="Standard" style="font-size: 2.5rem;">Standard Certification</label><br>
                    <input type="checkbox" name="subCheckbox1" id="subCheckbox1" style="margin-left: 2%;">
                    <label for="subCheckbox1">DLD (Department of Livestock Development's Organic Food Standards)</label><br>
                    <input type="checkbox" name="subCheckbox1" id="subCheckbox1" style="margin-left: 2%;">
                    <label for="subCheckbox1">IFOAM (The International Feeration of Organic Agriculture Movements)</label><br>
                    <input type="checkbox" name="subCheckbox1" id="subCheckbox1" style="margin-left: 2%;">
                    <label for="subCheckbox1">USDA Organic (The United States Department of Agriculture Orgain)</label><br>
                    <input type="checkbox" name="subCheckbox1" id="subCheckbox1" style="margin-left: 2%;">
                    <label for="subCheckbox1">EU Organic Regulation (European Union Organic Regulation)</label><br>
                    <input type="checkbox" name="subCheckbox1" id="subCheckbox1" style="margin-left: 2%;">
                    <label for="subCheckbox1">Canada Organic Syandards</label><br>
                    <input type="checkbox" name="subCheckbox1" id="subCheckbox1" style="margin-left: 2%;">
                    <label for="subCheckbox1">JAS Organic (The Japanese Agriculture Standards Organic)</label><br>
            </div>
            <div class="container-r4">
                <label class="boldLabel" for="FDA" style="font-size: 2.5rem;">Food and Drug Administration(FDA)</label><br>
                <input type="number" id="FDA" name="FDA" style="width: 45%;" required>

            </div>
        </div>
        
        </div>

    </div>
    <input id="btn" type="submit" value="Submit">
    </form>

    <!--Script for Sub-Checkbox(Quality of milk)-->
    <script>
        function toggleSubCheckboxes(mainCheckboxId, subElementId){
            var mainCheckbox = document.getElementById(mainCheckboxId);
            var subElement = document.getElementById(subElementId);

            // show / hide sub-element ตามสถานะการ click ของ main-checkbox
            if(mainCheckbox.checked){
                subElement.style.display = "block"; //show sub-checkbox
            
            } else{
                subElement.style.display = "none"; //hide
            }

        }
    </script>

    <script>
        document.getElementById('milkForm').addEventListener('submit', function(e) {
            e.preventDefault(); // ป้องกันไม่ให้หน้าโหลดซ้ำ
            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());

            fetch('/submit', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data),
            })
            .then(response => response.json())
            .then(data => {
                console.log('สำเร็จ:', data);
                window.location.href = '/display';  // เมื่อส่งข้อมูลแล้วให้เปลี่ยนไปยังหน้าที่แสดงข้อมูล
            })
            .catch((error) => {
                console.error('เกิดข้อผิดพลาด:', error);
            });
        });
    </script>

    <!--Script for Google Map part-->
    <script>
        let Gmap;
        let marker;

        function initMap() {
        Gmap = new google.maps.Map(document.getElementById("Gmap"), {
            center: { lat: 13.7563, lng: 100.5018 },
            zoom: 10,
        });

        Gmap.addListener("click", (event) => {
            placeMarker(event.latLng);
            updateCoordinates(event.latLng);
        });
    }

    function placeMarker(location) {
        if (marker) {
            marker.setMap(null); // remove old marker
        }

        marker = new google.maps.Marker({ // set new marker
            position: location,
            map: Gmap,
        });
    }

    function updateCoordinates(location) {
        const lat = location.lat();
        const lng = location.lng();
        document.getElementById("coordinates").innerText = `Latitude: ${lat}, Longitude: ${lng}`;
        document.getElementById("LocationLink").value = `https://maps.google.com/?q=${lat},${lng}`; // Update input with Google Maps link
    }

    document.getElementById("LocationLink").addEventListener("change", function() {
        const url = this.value;
        const latLng = getLatLngFromURL(url);
        if (latLng) {
            placeMarker(latLng);
            Gmap.setCenter(latLng);
            updateCoordinates(latLng);
        }
    });

    function getLatLngFromURL(url) {
    const regex = /@(-?\d+\.\d+),(-?\d+\.\d+)/;
    const match = url.match(regex);
    if (match) {
        const lat = parseFloat(match[1]);
        const lng = parseFloat(match[2]);
        return { lat, lng };
    }
    return null;
    }
    </script>

    <!--Script for API Google Map-->
    <script async defer 
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB4l6cSn6f3m4FLynCgDAvGN12rwgl4LvU&callback=initMap">

    </script>
</body>
</html>